-- V9__Adicionar_novos_procedimentos_e_consultas.sql

-- 1. Remove a constraint antiga para evitar erros ao adicionar a nova.
ALTER TABLE solicitacao_especialidade
DROP CONSTRAINT IF EXISTS solicitacao_especialidade_especialidade_solicitada_check;

-- 2. Adiciona a nova constraint com a lista COMPLETA E ATUALIZADA de todos os enums.
ALTER TABLE solicitacao_especialidade
ADD CONSTRAINT solicitacao_especialidade_especialidade_solicitada_check
CHECK (especialidade_solicitada IN (
    'ANGIOLOGISTA','ALERGOLOGISTA', 'CARDIOLOGISTA', 'ENDOCRINOLOGISTA', 'GASTROENTEROLOGISTA',
    'PROCTOLOGISTA',
    'MASTOLOGISTA', 'DERMATOLOGISTA', 'NEFROLOGISTA', 'ORTOPEDISTA',
    'OFTALMOLOGISTA', 'NEUROLOGISTA', 'NEUROPEDIATRIA', 'PEDIATRIA',
    'OTORRINOLARINGOLOGISTA', 'UROLOGISTA', 'REUMATOLOGISTA', 'PNEUMOLOGISTA',
    'HEMATOLOGISTA', 'CONSULTA_OFTALMOLOGICA_REFRACAO', 'CIRURGIAO_GERAL',
    'DOPPLER', 'MAMOGRAFIA', 'HOLTER', 'TESTE_ERGOMETRICO', 'MAPA',
    'TOMOGRAFIA', 'RESSONANCIA', 'CINTILOGRAFIA', 'ELETRONEUROMIOGRAFIA',
    'CATETERISMO', 'HEMOGRAMA_COMPLETO', 'GLICEMIA_JEJUM', 'HEMOGLOBINA_GLICADA_HBA1C',
    'COLESTEROL_TOTAL', 'HDL_COLESTEROL', 'LDL_COLESTEROL', 'VLDL_COLESTEROL',
    'TRIGLICERIDEOS', 'UREIA', 'CREATININA', 'SODIO', 'POTASSIO', 'ACIDO_URICO',
    'SUMARIO_DE_URINA_EAS', 'UROCULTURA_COM_ANTIBIOGRAMA', 'PARASITOLOGICO_DE_FEZES',
    'PESQUISA_SANGUE_OCULTO_FEZES', 'TESTE_RAPIDO_GRAVIDEZ_TIG', 'TESTE_RAPIDO_HIV',
    'SOROLOGIA_HIV', 'TESTE_RAPIDO_SIFILIS', 'VDRL', 'TESTE_RAPIDO_HEPATITE_B',
    'HBSAG', 'ANTI_HBS', 'TESTE_RAPIDO_HEPATITE_C', 'ANTI_HCV',
    'TSH_HORMONIO_TIREOESTIMULANTE', 'T4_LIVRE', 'PSA_TOTAL', 'PSA_LIVRE',
    'BACILOSCOPIA_DE_ESCARRO_BAAR', 'CULTURA_DE_ESCARRO',
    'ELETROCARDIOGRAMA_ECG', 'COLPOSCOPIA', 'BIOPSIA_COLO_UTERINO', 'MAMOGRAFIA_BILATERAL',
    'ULTRASSONOGRAFIA_PARTES_MOLES', 'ULTRASSONOGRAFIA_ABDOMINAL_TOTAL',
    'ULTRASSONOGRAFIA_ABDOMEN_SUPERIOR', 'ULTRASSONOGRAFIA_PELVICA_VIA_ABDOMINAL',
    'ULTRASSONOGRAFIA_PELVICA_TRANSVAGINAL', 'ULTRASSONOGRAFIA_OBSTETRICA',
    'ULTRASSONOGRAFIA_VIAS_URINARIAS', 'ULTRASSONOGRAFIA_PROSTATA_VIA_ABDOMINAL',
    'ULTRASSONOGRAFIA_TIREOIDE', 'ULTRASSONOGRAFIA_ARTICULAR',
    'ULTRASSONOGRAFIA_DOPPLER_ARTERIAL_MEMBRO_INFERIOR_UNILATERAL',
    'ULTRASSONOGRAFIA_DOPPLER_ARTERIAL_MEMBRO_INFERIOR_BILATERAL',
    'ULTRASSONOGRAFIA_DOPPLER_VENOSO_MEMBRO_INFERIOR_UNILATERAL',
    'ULTRASSONOGRAFIA_DOPPLER_VENOSO_MEMBRO_INFERIOR_BILATERAL',
    'ULTRASSONOGRAFIA_DOPPLER_CAROTIDAS_E_VERTEBRAIS', 'RAIO_X_TORAX_PA',
    'RAIO_X_TORAX_PA_PERFIL', 'RAIO_X_SEIOS_DA_FACE', 'RAIO_X_COLUNA_CERVICAL',
    'RAIO_X_COLUNA_DORSAL', 'RAIO_X_COLUNA_LOMBO_SACRA', 'RAIO_X_ABDOMEN_SIMPLES',
    'RAIO_X_ABDOMEN_AGUDO', 'RAIO_X_ARTICULACAO_COXO_FEMURAL_BACIA', 'RAIO_X_JOELHO',
    'RAIO_X_MAO_OU_QUIRODACTILOS', 'RAIO_X_PE_OU_PODODACTILOS', 'RAIO_X_CALCANEO',
    'RAIO_X_COLUNA_LOMBAR',
    'RAIO_X_OMBRO',
    'RAIO_X_CAVUM',
    'RAIO_X_COLUNA_TORACICA',
    'RAIO_X_ESCAPULA',
    'RAIO_X_REGIAO_CERVICAL',
    'TESTE_ERGOMETRICO_CONVENCIONAL', 'HOLTER_24_HORAS_3_CANAIS',
    'MAPA_24_HORAS_MONITORIZACAO_AMBULATORIAL_PRESSAO_ARTERIAL',
    'ENDOSCOPIA_DIGESTIVA_ALTA', 'ENDOSCOPIA_DIGESTIVA_ALTA_COM_BIOPSIA',
    'COLONOSCOPIA', 'COLONOSCOPIA_COM_BIOPSIA',
    'AUDIOMETRIA_TONAL_LIMIAR_COM_TESTES_DE_DISCRIMINACAO', 'IMPEDANCIOMETRIA',
    'FUNDOSCOPIA_BINOCULAR_INDIRETA', 'TONOMETRIA_APLANACAO',
    'DENSITOMETRIA_OSSEA_COLUNA_E_FEMUR',
    'ECOCARDIOGRAMA_TRANSTORACICO_MODO_M_BIDIMENSIONAL_DOPPLER',
    'ESPIROMETRIA_PROVA_VENTILATORIA_COMPLETA', 'ELETROENCEFALOGRAMA_CONVENCIONAL',
    'TOMOGRAFIA_COMPUTADORIZADA_CRANIO', 'TOMOGRAFIA_COMPUTADORIZADA_TORAX',
    'TOMOGRAFIA_COMPUTADORIZADA_ABDOMEN_TOTAL', 'RESSONANCIA_MAGNETICA_CRANIO_ENCEFALO',
    'RESSONANCIA_MAGNETICA_COLUNA_CERVICAL', 'RESSONANCIA_MAGNETICA_COLUNA_LOMBAR',
    'RESSONANCIA_MAGNETICA_JOELHO', 'CINTILOGRAFIA_MIOCARDIO_PERFUSAO_REPOUSO_ESTRESSE',
    'CINTILOGRAFIA_TIREOIDE_CAPTACAO', 'CINTILOGRAFIA_OSSEA',
    'ELETRONEUROMIOGRAFIA_MEMBROS_SUPERIORES', 'ELETRONEUROMIOGRAFIA_MEMBROS_INFERIORES',
    'CATETERISMO_CARDIACO_ESQUERDO_DIAGNOSTICO', 'AVALIACAO_URODINAMICA_COMPLETA',
    'TGO', 'TGP', 'FATOR_REUMATOIDE', 'PESQUISA_OVOS_CISTOS_PARASITAS',
    'GAMA_GT', 'COAGULOGRAMA', 'ASLO', 'CALCIO', 'FOSFATASE_ALCALINA',
    'BILIRRUBINA_TOTAL_FRACOES', 'TIPO_SANGUINEO', 'TP', 'TTPA',
    'EXERESE_PEQUENAS_LESOES_PELE_ANATOMOPATOLOGICO',

    -- NOVOS EXAMES E PROCEDIMENTOS ADICIONADOS
    'ANALISE_CARACTERES_FISICOS_ELEMENTOS_SEDIMENTO_URINA',
    'ANTIBIOGRAMA',
    'BACILOSCOPIA_DIRETA_BAAR_TUBERCULOS_CONTROLE',
    'BACILOSCOPIA_DIRETA_BAAR_TUBERCULOSE_DIAGNOSTICA',
    'BACTEROSCOPIA_GRAM',
    'CLEARANCE_CREATININA',
    'CONTAGEM_PLAQUETAS',
    'CONTAGEM_RETICULOCITOS',
    'CULTURA_BACTERIAS_IDENTIFICACAO_UROCULTURA',
    'DETERMINACAO_CAPACIDADE_FIXACAO_FERRO',
    'DETERMINACAO_CURVA_GLICEMICA_2_DOSAGENS',
    'DETERMINACAO_LATEX',
    'DETERMINACAO_TEMPO_COAGULACAO',
    'DETERMINACAO_TEMPO_SANGRAMENTO_IVY',
    'DETERMINACAO_TEMPO_SANGRAMENTO_DUKE',
    'DETERMINACAO_TEMPO_TROMBINA',
    'DETERMINACAO_VELOCIDADE_HEMOSSEDIMENTACAO_VHS',
    'DETERMINACAO_DIRETA_REVERSA_GRUPO_ABO',
    'DETERMINACAO_QUANTITATIVA_PROTEINA_C_REATIVA',
    'DOSAGEM_25_HIDROXIVITAMINA_D',
    'DOSAGEM_ALBUMINA',
    'DOSAGEM_ALFA_1_ANTITRIPSINA',
    'DOSAGEM_ALFA_FETOPROTEINA',
    'DOSAGEM_AMILASE',
    'DOSAGEM_CALCIO_IONIZAVEL',
    'DOSAGEM_COMPLEMENTO_C3',
    'DOSAGEM_COMPLEMENTO_C4',
    'DOSAGEM_CORTISOL',
    'DOSAGEM_CREATINOFOSFOQUINASE_CPK',
    'DOSAGEM_CREATINOFOSFOQUINASE_FRACAO_MB',
    'DOSAGEM_DEHIDROEPIANDROSTERONA_DHEA',
    'DOSAGEM_DESIDROGENASE_LATICA',
    'DOSAGEM_ESTRADIOL',
    'DOSAGEM_ESTRIOL',
    'DOSAGEM_ESTRONA',
    'DOSAGEM_FERRITINA',
    'DOSAGEM_FERRO_SERICO',
    'DOSAGEM_FOSFATASE_ACIDA_TOTAL',
    'DOSAGEM_FOSFORO',
    'DOSAGEM_GONADOTROFINA_CORIONICA_HUMANA_HCG_BETA_HCG',
    'DOSAGEM_HAPTOGLOBINA',
    'DOSAGEM_HEMOGLOBINA',
    'DOSAGEM_HEMOGLOBINA_GLICOSILADA',
    'DOSAGEM_HORMONIO_FOLICULO_ESTIMULANTE_FSH',
    'DOSAGEM_HORMONIO_LUTEINIZANTE_LH',
    'DOSAGEM_IMUNOGLOBULINA_A_IGA',
    'DOSAGEM_IMUNOGLOBULINA_E_IGE',
    'DOSAGEM_IMUNOGLOBULINA_M_IGM',
    'DOSAGEM_INSULINA',
    'DOSAGEM_LACTATO',
    'DOSAGEM_LIPASE',
    'DOSAGEM_LITIO',
    'DOSAGEM_MAGNESIO',
    'DOSAGEM_MICROALBUMINA_NA_URINA',
    'DOSAGEM_MUCO_PROTEINAS',
    'DOSAGEM_PARATORMONIO',
    'DOSAGEM_PROGESTERONA',
    'DOSAGEM_PROLACTINA',
    'DOSAGEM_PROTEINAS_URINA_24_HORAS',
    'DOSAGEM_PROTEINAS_TOTAIS',
    'DOSAGEM_PROTEINAS_TOTAIS_E_FRACOES',
    'DOSAGEM_SULFATO_DE_HIDROEPIANDROSTERONA_DHEAS',
    'DOSAGEM_TESTOSTERONA',
    'DOSAGEM_TESTOSTERONA_LIVRE',
    'DOSAGEM_TIREOGLOBULINA',
    'DOSAGEM_TIROXINA_T4',
    'DOSAGEM_TRANSFERRINA',
    'DOSAGEM_TRIIODOTIRONINA_T3',
    'DOSAGEM_TROPONINA',
    'DOSAGEM_VITAMINA_B12',
    'DOSAGEM_ZINCO',
    'ELETROFORESE_DE_HEMOGLOBINA',
    'ELETROFORESE_DE_LIPOPROTEINAS',
    'ERITROGRAMA',
    'EXAME_CARACTERES_FISICOS_CONTAGEM_GLOBAL_ESPECIFICA_CELULAS',
    'HEMATOCRITO',
    'HEMOCULTURA',
    'IMUNOELETROFORESE_DE_PROTEINAS',
    'LEUCOGRAMA',
    'PESQUISA_ANTICORPO_IGG_ANTICARDIOLIPINA',
    'PESQUISA_ANTICORPO_IGM_DE_ANTICARDIOLIPINA',
    'PESQUISA_ANTICORPOS_ANTI_HELICOBACTER_PYLORI',
    'PESQUISA_ANTICORPOS_ANTI_HIV_1_HIV_2_ELISA',
    'PESQUISA_ANTICORPOS_ANTI_HTLV_1_HTLV_2',
    'PESQUISA_ANTICORPOS_ANTINUCLEO',
    'PESQUISA_ANTICORPOS_ANTI_SM',
    'PESQUISA_ANTICORPOS_ANTI_SS_A_RO',
    'PESQUISA_ANTICORPOS_ANTI_SS_B_LA',
    'PESQUISA_ANTICORPOS_ANTITIREOGLOBULINA',
    'PESQUISA_ANTICORPOS_CONTRA_ANTIGENO_E_VIRUS_HEPATITE_B_ANTI_HBE',
    'PESQUISA_ANTICORPOS_CONTRA_VIRUS_HEPATITE_D_ANTI_HDV',
    'PESQUISA_ANTICORPOS_CONTRA_VIRUS_SARAMPO',
    'PESQUISA_ANTICORPOS_IGG_ANTICITOMEGALOVIRUS',
    'PESQUISA_ANTICORPOS_IGG_ANTILEISHMANIAS',
    'PESQUISA_ANTICORPOS_IGG_ANTITOXOPLASMA',
    'PESQUISA_ANTICORPOS_IGG_ANTITRYPANOSOMA_CRUZI',
    'PESQUISA_ANTICORPOS_IGG_CONTRA_ANTIGENO_CENTRAL_VIRUS_HEPATITE_B_ANTI_HBC_IGG',
    'PESQUISA_ANTICORPOS_IGG_CONTRA_VIRUS_HEPATITE_A_HAV_IGG',
    'PESQUISA_ANTICORPOS_IGG_CONTRA_VIRUS_RUBEOLA',
    'PESQUISA_ANTICORPOS_IGG_CONTRA_VIRUS_VARICELA_HERPES_ZOSTER',
    'PESQUISA_ANTICORPOS_IGG_CONTRA_VIRUS_EPSTEIN_BARR',
    'PESQUISA_ANTICORPOS_IGM_ANTICITOMEGALOVIRUS',
    'PESQUISA_ANTICORPOS_IGM_ANTILEISHMANIAS',
    'PESQUISA_ANTICORPOS_IGM_ANTITOXOPLASMA',
    'PESQUISA_ANTICORPOS_IGM_ANTITRYPANOSOMA_CRUZI',
    'PESQUISA_ANTICORPOS_IGM_CONTRA_ANTIGENO_CENTRAL_VIRUS_HEPATITE_B_ANTI_HBC_IGM',
    'PESQUISA_ANTICORPOS_IGM_CONTRA_VIRUS_HEPATITE_A_HAV_IGG',
    'PESQUISA_ANTICORPOS_IGM_CONTRA_VIRUS_RUBEOLA',
    'PESQUISA_ANTIGENO_CARCINOEMBRIONARIO_CEA',
    'PESQUISA_ANTIGENO_E_VIRUS_HEPATITE_B_HBEAG',
    'PESQUISA_FATOR_REUMATOIDE_WAALER_ROSE',
    'PESQUISA_FATOR_RH_INCLUI_D_FRACO',
    'PESQUISA_HEMOGLOBINA_S',
    'PESQUISA_LARVAS_NAS_FEZES',
    'PESQUISA_TRIPANOSSOMA',
    'PESQUISA_TROFOZOITAS_NAS_FEZES',
    'PROVA_RETRACAO_COAGULO',
    'PROVA_DO_LACO',
    'REACAO_HEMAGLUTINACAO_TPHA_DIAGNOSTICO_SIFILIS',
    'REACAO_MONTENEGRO_ID',
    'TESTE_VDRL_DETECCAO_SIFILIS',
    'TESTE_DIRETO_ANTIGLOBULINA_HUMANA_TAD',
    'TESTE_FTA_ABS_IGG_DIAGNOSTICO_SIFILIS',
    'TESTE_FTA_ABS_IGM_DIAGNOSTICO_SIFILIS',
    'TESTE_TUBERCULINICO_PPD',
    'VDRL_DETECCAO_SIFILIS_EM_GESTANTE',

    -- NOVOS EXAMES DE IMAGEM
    'ANGIORESSONANCIA_CEREBRAL_ARTERIAL',
    'ANGIORESSONANCIA_DE_CRANIO_ARTERIAL',
    'RESSONANCIA_MAGNETICA_ARTICULACAO_TEMPORO_MANDIBULAR_BILATERAL',
    'RESSONANCIA_MAGNETICA_BACIA_PELVE_ABDOMEN_INFERIOR',
    'RESSONANCIA_MAGNETICA_COLUNA_TORACICA',
    'RESSONANCIA_MAGNETICA_CORACAO_AORTA_COM_CINE',
    'RESSONANCIA_MAGNETICA_MEMBRO_INFERIOR_UNILATERAL',
    'RESSONANCIA_MAGNETICA_MEMBRO_SUPERIOR_UNILATERAL',
    'RESSONANCIA_MAGNETICA_SELA_TURCICA',
    'RESSONANCIA_MAGNETICA_TORAX',
    'RESSONANCIA_MAGNETICA_VIAS_BILIARES_COLANGIORESSONANCIA',
    'TOMOGRAFIA_COMPUTADORIZADA_ARTICULACOES_MEMBRO_INFERIOR',
    'TOMOGRAFIA_COMPUTADORIZADA_ARTICULACOES_MEMBRO_SUPERIOR',
    'TOMOGRAFIA_COMPUTADORIZADA_COLUNA_CERVICAL_COM_OU_SEM_CONTRASTE',
    'TOMOGRAFIA_COMPUTADORIZADA_COLUNA_LOMBOSACRA_COM_OU_SEM_CONTRASTE',
    'TOMOGRAFIA_COMPUTADORIZADA_COLUNA_TORACICA_COM_OU_SEM_CONTRASTE',
    'TOMOGRAFIA_COMPUTADORIZADA_FACE_SEIOS_DA_FACE_ARTICULACOES_TEMPO_MANDIBULARES',
    'TOMOGRAFIA_COMPUTADORIZADA_PELVE_BACIA_ABDOMEN_INFERIOR',
    'TOMOGRAFIA_COMPUTADORIZADA_SEGMENTOS_APENDICULARES',
    'TOMOGRAFIA_COMPUTADORIZADA_SELA_TURCICA',
    'TOMOGRAFIA_COMPUTADORIZADA_PESCOCO',
    'TOMOGRAFIA_POR_EMISSAO_DE_POSITRONS_PET_CT',
    'GLICOSE',
    'TOMOMIELOGRAFIA_COMPUTADORIZADA',
    'ANGIOTOMOGRAFIA',
    'OFTALMOLOGISTA_ESPECIALISTA_EM_RETINA', 
    'OFTALMOLOGISTA_ESPECIALISTA_EM_GLAUCOMA', 
    'RETINOLOGO', 
    'ESPECILISTA_EM_OMBRO', 
    'ESPECIALISTA_EM_JOELHO', 
    'ESPECIALISTA_EM_QUADRIL', 
    'ESPECIALISTA_EM_COLUNA', 
    'ESPECIALISTA_EM_PE', 
    'ESPECIALISTA_EM_MAO', 
    'ESPECIASTA_EM_REDUCAO_DE_MAMA', 
    'ONCOLOGISTA',
    'GINECOLOGISTA',
    'TOTG_75G',
    'ACIDO_FOLICO',
    'COLESTEROL_TOTAL_E_FRACOES'
));

ALTER TABLE solicitacao
DROP CONSTRAINT IF EXISTS solicitacao_usf_origem_check;

-- 2. Adiciona a nova constraint com a lista COMPLETA E ATUALIZADA de todas as USFs.
-- Adicione a sua nova USF (ex: 'USF07') à lista.
ALTER TABLE solicitacao
ADD CONSTRAINT solicitacao_usf_origem_check
CHECK (usf_origem IN (
    'USF01',
    'USF02',
    'USF03',
    'USF04',
    'USF05',
    'USF06',
    'HMCA' -- Nova USF adicionada aqui
));